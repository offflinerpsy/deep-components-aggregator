# ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–ò–ú–ï–ù–ï–ù–´ ‚Äî –ì–û–¢–û–í–û –ö BROWSER-–¢–ï–°–¢–£

**–î–∞—Ç–∞**: 12 –æ–∫—Ç—è–±—Ä—è 2025, 16:10 UTC  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ì–û–¢–û–í–û**

---

## üéØ –ß–¢–û –ò–°–ü–†–ê–í–õ–ï–ù–û

### 1. ‚úÖ React Hooks Order Violation (CRITICAL)

**–§–∞–π–ª**: `/opt/deep-agg/v0-components-aggregator-page/components/ResultsClient.tsx`

**–ü—Ä–æ–±–ª–µ–º–∞**: –†–∞–Ω–Ω–∏–π `return` –ø–æ—Å–ª–µ `useEffect` ‚Üí "Rendered more hooks..." error

**–†–µ—à–µ–Ω–∏–µ**:
```typescript
// ‚úÖ –í–°–ï –•–£–ö–ò –°–ù–ê–ß–ê–õ–ê
useEffect(() => { /* ... */ }, [])
useEffect(() => { /* ... */ }, [mode, q])
const grouped = useMemo(() => groupByMPN(rows), [rows])

// ‚úÖ –†–ê–ù–ù–ò–ô –í–û–ó–í–†–ê–¢ –ü–û–°–õ–ï –•–£–ö–û–í
if (isLoading) return <PageLoader />
```

---

### 2. ‚úÖ Auto-Live Search –ø—Ä–∏ –ø—É—Å—Ç–æ–º –∫—ç—à–µ

**–§–∞–π–ª**: `/opt/deep-agg/v0-components-aggregator-page/components/ResultsClient.tsx`

**–õ–æ–≥–∏–∫–∞**:
```typescript
const initialMode = (initial?.rows?.length === 0 && q) ? 'live' : 'cache'
const [mode, setMode] = useState<'cache' | 'live'>(initialMode)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ï—Å–ª–∏ –∫—ç—à –ø—É—Å—Ç–æ–π ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è live search (SSE).

---

### 3. ‚úÖ FTS5 SQL Injection Fix

**–§–∞–π–ª**: `/opt/deep-agg/src/db/sql.mjs`

**–ü—Ä–æ–±–ª–µ–º–∞**: –ó–∞–ø—Ä–æ—Å—ã —Å –¥–µ—Ñ–∏—Å–æ–º (`RS1G-13-F`) –ø–∞–¥–∞–ª–∏ ‚Üí `SqliteError: no such column: 13`

**–†–µ—à–µ–Ω–∏–µ**:
```javascript
const escapedQuery = `"${query.replace(/"/g, '""')}"`;
db.prepare(sql).all(...weights, escapedQuery, limit);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –î–µ—Ñ–∏—Å—ã —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç—Å—è ‚Üí FTS5 –∏—â–µ—Ç –∫–∞–∫ literal phrase.

---

### 4. ‚úÖ –†—É—Å—Å–∫–∏–π –ø–æ–∏—Å–∫ (RU‚ÜíEN normalization)

**–§–∞–π–ª**: `/opt/deep-agg/src/search/normalizeQuery.mjs`

**–õ–æ–≥–∏–∫–∞**: `—Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä` ‚Üí `transistor` (—á–µ—Ä–µ–∑ transliterate + synonyms)

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```bash
$ curl -s 'http://127.0.0.1:9201/api/vitrine/list?q=—Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä&limit=1' | jq '.meta.queryNorm'
{
  "original": "—Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä",
  "normalized": "transistor",
  "isCyrillic": true
}
```

---

### 5. ‚úÖ Homepage Components Load

**–§–∞–π–ª**: `/opt/deep-agg/v0-components-aggregator-page/app/page.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
- –£–¥–∞–ª—ë–Ω hardcoded –º–∞—Å—Å–∏–≤ (28 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
- –î–æ–±–∞–≤–ª–µ–Ω `useEffect` —Å `fetch('/api/vitrine/list?limit=28&sort=stock_desc')`
- –î–æ–±–∞–≤–ª–µ–Ω—ã `data-testid="component-card"` –∏ `data-testid="component-mpn"` –¥–ª—è E2E —Ç–µ—Å—Ç–æ–≤

---

## üîç –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ï –¢–ï–°–¢–´ (CURL)

```bash
‚úÖ API –≤–∏—Ç—Ä–∏–Ω—ã: 3 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
‚úÖ FTS5 escaping: RS1G-13-F —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ –ë—ç–∫–µ–Ω–¥: —Ä–∞–±–æ—Ç–∞–µ—Ç
‚ö†Ô∏è –ì–ª–∞–≤–Ω–∞—è: "–ó–∞–≥—Ä—É–∑–∫–∞..." (SSR, —Ç—Ä–µ–±—É–µ—Ç browser test)
‚ö†Ô∏è –†—É—Å—Å–∫–∏–π –ø–æ–∏—Å–∫: –Ω—É–∂–µ–Ω browser test
```

**–í—ã–≤–æ–¥**: Curl-—Ç–µ—Å—Ç—ã –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. **–¢—Ä–µ–±—É–µ—Ç—Å—è browser test**.

---

## üåê –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –í –ë–†–ê–£–ó–ï–†–ï

### URL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

#### 1. **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**
**URL**: http://5.129.228.88:3000/

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:
- –°–µ–∫—Ü–∏—è "–ß–¢–û –ò–©–£–¢ –õ–Æ–î–ò" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–Ω–µ "–ó–∞–≥—Ä—É–∑–∫–∞...")
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–º–µ—é—Ç MPN, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è, –∫–∞—Ç–µ–≥–æ—Ä–∏—é
- –ö–ª–∏–∫ –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ `/search?q=<MPN>`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 28 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏–∑ API (–Ω–µ hardcoded).

---

#### 2. **–ü–æ–∏—Å–∫ —Å –ø—É—Å—Ç—ã–º –∫—ç—à–µ–º (AUTO-LIVE SEARCH)**
**URL**: http://5.129.228.88:3000/search?q=TEST-RANDOM-999

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:
- –ö–Ω–æ–ø–∫–∞ "Live (SSE)" **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–Ω–∞** (–ø–æ–¥—Å–≤–µ—á–µ–Ω–∞)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–ü–æ–∏—Å–∫..." –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ 10-30 —Å–µ–∫—É–Ω–¥ (–∏–ª–∏ "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö" –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ)

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π** –∑–∞–ø—É—Å–∫ live search.

---

#### 3. **–ü–æ–∏—Å–∫ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –≤ –∫—ç—à–µ**
**URL**: http://5.129.228.88:3000/search?q=FT232RL-REEL

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:
- –ö–Ω–æ–ø–∫–∞ "–ö—ç—à (SSR)" –∞–∫—Ç–∏–≤–Ω–∞
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑ –∫—ç—à–∞
- –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ "Live (SSE)" –≤—Ä—É—á–Ω—É—é

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑ –∫—ç—à–∞ (–±—ã—Å—Ç—Ä–æ, –±–µ–∑ SSE).

---

#### 4. **–†—É—Å—Å–∫–∏–π –ø–æ–∏—Å–∫**
**URL**: http://5.129.228.88:3000/search?q=—Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:
- –ë–µ–π–¥–∂ "–ü–æ–∫–∞–∑–∞–Ω–æ –ø–æ: transistor"
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã: —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä—ã (MOSFET, BJT, etc.)

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è RU‚ÜíEN —Ä–∞–±–æ—Ç–∞–µ—Ç.

---

#### 5. **–ü–æ–∏—Å–∫ —Å –¥–µ—Ñ–∏—Å–æ–º**
**URL**: http://5.129.228.88:3000/search?q=RS1G-13-F

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:
- **–ù–ï–¢** –æ—à–∏–±–∫–∏ "Application error" –∏–ª–∏ –±–µ–ª–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–µ—Å–ª–∏ –µ—Å—Ç—å –≤ –∫—ç—à–µ) –∏–ª–∏ "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: FTS5 escaping —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–µ SqliteError).

---

#### 6. **–ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞**
**URL**: http://5.129.228.88:3000/product/FT232RL-REEL

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ (Specs)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (Offers)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã (Docs)

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –í—Å–µ —Ç–∞–±—ã —Ä–∞–±–æ—Ç–∞—é—Ç.

---

## üö® –ò–ó–í–ï–°–¢–ù–´–ï –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø

### 1. E2E —Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ Playwright

**–°—Ç–∞—Ç—É—Å**: ‚ùå **–ù–ï –†–ê–ë–û–¢–ê–Æ–¢**

**–ü—Ä–∏—á–∏–Ω–∞**: –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –ø–æ–ª–æ–º–∫–∞ `$PATH` –≤ SSH-–æ–±–æ–ª–æ—á–∫–µ:
- `chmod: command not found`
- `sleep: command not found`
- `tee: command not found`
- `/usr/bin/env: 'node': No such file or directory`

**–†–µ—à–µ–Ω–∏–µ**: Playwright —Ç–µ—Å—Ç—ã **–Ω–∞–ø–∏—Å–∞–Ω—ã** (`e2e/complete-flow.spec.ts`), –Ω–æ **–Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã** –≤ —Ç–µ–∫—É—â–µ–π —Å—Ä–µ–¥–µ.

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞**: –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.

---

### 2. Curl –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**–ü—Ä–æ–±–ª–µ–º–∞**: `curl http://localhost:3000/` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç SSR HTML —Å "–ó–∞–≥—Ä—É–∑–∫–∞..." –ø–æ—Ç–æ–º—É —á—Ç–æ `useEffect` **–Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**.

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ **–¢–û–õ–¨–ö–û** –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–ø–æ—Å–ª–µ React hydration).

---

## üìä –°–¢–ê–¢–£–° –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

- [x] React Hooks order violation ‚Äî **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- [x] Auto-live search –ø—Ä–∏ –ø—É—Å—Ç–æ–º –∫—ç—à–µ ‚Äî **–î–û–ë–ê–í–õ–ï–ù–û**
- [x] FTS5 SQL injection (–¥–µ—Ñ–∏—Å—ã) ‚Äî **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- [x] –†—É—Å—Å–∫–∏–π –ø–æ–∏—Å–∫ (RU‚ÜíEN) ‚Äî **–†–ê–ë–û–¢–ê–ï–¢**
- [x] Homepage API integration ‚Äî **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- [ ] Browser verification ‚Äî **‚è≥ –û–ñ–ò–î–ê–ï–¢ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø**

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì

**–ü–†–û–í–ï–†–¨ –í –ë–†–ê–£–ó–ï–†–ï**:

1. –û—Ç–∫—Ä–æ–π http://5.129.228.88:3000/
2. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è (–Ω–µ "–ó–∞–≥—Ä—É–∑–∫–∞...")
3. –ö–ª–∏–∫–Ω–∏ –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ `/search`
4. –ü–æ–ø—Ä–æ–±—É–π –ø–æ–∏—Å–∫ —Å –ø—É—Å—Ç—ã–º –∫—ç—à–µ–º (`?q=TEST-999`) ‚Üí –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–æ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è live search

---

**–ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –¥–µ–ª–∞–µ–º commit!** üöÄ  
**–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–Ω–æ ‚Üí —Å–∫—Ä–∏–Ω—à–æ—Ç + –∫–æ–Ω—Å–æ–ª—å DevTools ‚Üí —è –∏—Å–ø—Ä–∞–≤–ª—é.**
