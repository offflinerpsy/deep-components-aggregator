# ТЗ: Каталог-превью (10 товаров) + «вежливый советовальщик» + антиспам поисков

Дата: 2026-01-21

## Контекст и цель
- Цель: сделать каталог «живым» без лишних обращений к провайдерам.
- Ожидается низкая нагрузка, поэтому **не вводим жёстких лимитов** на реальные поиски.
- Но нужна **защита от «дурака»**: если пользователь подряд делает много поисков «наугад», мы мягко останавливаем и помогаем сформулировать запрос.

## Принятые решения
1) **Каталог / категории (leaf)** показывают **10 товаров из кэша** (через `/api/vitrine/list`, без провайдеров).
2) Кнопка **«Показать ещё»** не разворачивает бесконечный список, а открывает **нижний шит-помощник**:
   - предлагает поиск конкретной модели/параметров,
   - даёт быстрые примеры запросов,
   - опционально (вторичной кнопкой) позволяет **показать ещё 10 из кэша**.
3) **Реальные поиски** (SSE `/api/live/search`) не ограничиваем.
4) **Антиспам**: если пользователь инициирует **>10 поисков за 60 секунд**, показываем помощника:
   - вопрос «что именно ищете?»
   - советы «как искать правильно»
   - кнопка «Искать всё равно» (не блокируем, только добавляем осознанность)

## UX тексты (черновик)
### Каталог (leaf), когда `q` пустой
- Под заголовком: «Показаны 10 популярных позиций из кэша. Чтобы найти конкретную модель — введите запрос.»

### Помощник при «Показать ещё»
Заголовок: «Подсказать, как быстрее найти нужное?»
- «Категории показывают короткую подборку из кэша. Если нужен конкретный компонент — лучше искать по MPN или по параметрам.»
- Быстрые вопросы:
  - «Есть точная модель (MPN) или ищете тип компонента?»
  - «Важен корпус/напряжение/ток/точность/питание?»
- Быстрые примеры кнопками:
  - «LM358»
  - «STM32F103C8T6»
  - «BSS138 SOT-23»
  - «резистор 10k 0603»
Кнопки:
- Primary: «Открыть поиск по всем источникам» (переводит в `?q=<ввод>`)
- Secondary: «Показать ещё 10 из кэша»

### Помощник при антиспаме
Заголовок: «Похоже, вы ищете наугад — давайте уточним»
- «Если есть точный артикул — введите его целиком (без пробелов).»
- «Если ищете аналог: добавьте корпус и параметры, например: “MOSFET N 30V SOT-23”.»
Кнопки:
- Primary: «Искать всё равно» (подтверждение последнего запроса)
- Secondary: «Понял(а), уточню запрос» (закрыть)

## Acceptance Criteria
- Leaf категория без `q` всегда показывает **ровно 10** результатов (или меньше, если кэш бедный) без провайдеров.
- «Показать ещё» открывает помощника и **не инициирует live-search**.
- Live-search запускается только при наличии `q`.
- При >10 поисков/60с появляется помощник перед следующим поиском.
- Сборка фронта проходит (`npm run build`).

## Задачи (чеклист)
- [ ] Обновить SSR-fetch в leaf: limit=10
- [ ] Добавить preview-режим в `ResultsClient` (previewLimit + cacheQuery)
- [ ] Добавить Sheet-помощник и кнопку «Показать ещё»
- [ ] Добавить антиспам-guard в `onSearch`
- [ ] Обновить текст на /catalog (root) про поведение
- [ ] Артефакты: ui-smoke-results.md
