# Chat Sessions

Синхронизация контекста между машинами через файловую систему проекта.

## Структура

```
docs/chats/
├── index.json                    # Индекс всех сессий
├── sessions/
│   └── YYYY-MM-DD-task-name/
│       ├── summary.md            # Краткое резюме (что сделано, что осталось)
│       ├── state.json            # Технический контекст (файлы, статусы, команды)
│       ├── conversation.md       # Полная история диалога
│       └── artifacts/            # Важные файлы из сессии
```

## Использование

### На сервере (Mac)
Контекст сохраняется автоматически после каждого таска.

### На Windows PC
```bash
# Синхронизировать репозиторий
git pull origin main

# Посмотреть список сессий
cat docs/chats/index.json | jq '.sessions'

# Прочитать последнюю сессию
cat docs/chats/sessions/2025-10-07-tme-pricing-coverage/summary.md

# Восстановить контекст
# 1. Прочитать summary.md - получить общую картину
# 2. Прочитать state.json - получить технические детали
# 3. При необходимости - conversation.md для полной истории

# Продолжить работу
# Просто начни диалог с ИИ, упомянув:
# "Подними контекст из docs/chats/sessions/2025-10-07-tme-pricing-coverage"
```

## Автоматическое сохранение

Агент сохраняет контекст:
- ✅ После завершения каждого таска из TODO
- ✅ Перед переключением на новую задачу
- ✅ После критичных изменений (фиксы багов, рефакторинг)
- ✅ По запросу: "сохрани контекст", "запиши чат"

## Формат файлов

### summary.md
Полное резюме сессии:
- Goal (цель)
- Completed Tasks (завершённые задачи)
- Current Status (текущий статус)
- Current Issues (текущие проблемы)
- Modified Files (изменённые файлы)
- Next Session TODO (что делать дальше)
- Commands for Next Session (команды для продолжения)

### state.json
Технический контекст:
```json
{
  "session_id": "...",
  "status": "in-progress",
  "tasks": [...],
  "files_modified": [...],
  "next_steps": [...],
  "providers_status": {...},
  "coverage_results": {...}
}
```

### conversation.md
Упрощённая история диалога (без технических деталей вроде stack traces).

## Правила

1. **Сжатие истории**: Убираем лишние детали (вывод команд, stack traces)
2. **Фокус на суть**: Что спросили → что сделали → что получили
3. **Структурированность**: Markdown с заголовками и таймстампами
4. **Технические детали**: В state.json, не в conversation.md

## Активные сессии

Смотри `docs/chats/index.json`
