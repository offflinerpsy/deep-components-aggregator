#!/usr/bin/env node
/**
 * Catalog Translation Script v5 - Final
 * Uses JSON for full category names + built-in dictionary for individual terms
 */
import Database from 'better-sqlite3';
import { readFileSync } from 'fs';
import { fileURLToPath } from 'url';
import { dirname, join } from 'path';

const __dirname = dirname(fileURLToPath(import.meta.url));
const DB_PATH = join(__dirname, '../var/db/deepagg.sqlite');
const TRANSLATIONS_PATH = join(__dirname, 'catalog-translations.json');

// Load exact full-category translations from JSON
const jsonData = JSON.parse(readFileSync(TRANSLATIONS_PATH, 'utf8'));
const exactTranslations = jsonData.exact;

// Mega term dictionary for word-by-word translation
const termDict = {
  'Reflectors': 'Рефлекторы',
  'Reflector': 'Рефлектор',
  'Phosphor': 'Люминофор',
  'Addressable': 'Адресуемые',
  'Electroluminescent': 'Электролюминесцентный',
  'MOVs': 'Варисторы',
  'Cutoffs': 'Отсечки',
  'Ground': 'Заземление',
  'Fault': 'Неисправность',
  'Interrupter': 'Прерыватель',
  'GFCI': 'УЗО',
  'Suppression': 'Подавление',
  'Sense': 'Чувствительный',
  'Pulse': 'Импульс',
  'Alone': 'Автономный',
  'Keystone': 'Keystone',
  'Jack': 'Розетка',
  'Jacks': 'Розетки',
  'PCs': 'ПК',

  'Drop': 'Падение',
  'Photon': 'Фотон',
  'Counting': 'Счётный',
  'Differential': 'Дифференциальный',
  'Autotransformers': 'Автотрансформаторы',
  'Step': 'Ступенчатый',
  'Circuitry': 'Схема',
  'Pogo': 'Подпружиненные',
  'Disk': 'Диск',
  'Excavators': 'Экскаваторы',
  'Hooks': 'Крючки',
  'Picks': 'Захваты',
  'Probes': 'Щупы',
  'Tuning': 'Настройка',
  'Asynchronous': 'Асинхронный',
  'Bars': 'Шкалы',
  'Bar': 'Шкала',
  'Graphs': 'Графики',
  'Graph': 'График',
  'Blankets': 'Покрывала',
  'Cold': 'Холодный',
  'Cathode': 'Катод',
  'Fluorescent': 'Флуоресцентный',
  'Lamps': 'Лампы',
  'Lamp': 'Лампа',
  'Instrumentation': 'Измерительные',
  'Tower': 'Башня',
  'Beacons': 'Маяки',
  'Beacon': 'Маяк',
  'Stackable': 'Наборные',
  'Maintenance': 'Обслуживание',
  'Customization': 'Кастомизация',
  'Connects': 'Коннекторы',
  'Quick': 'Быстро',
  'Disconnect': 'Разъединяемые',
  'Slot': 'Щелевой',
  'Selectable': 'Переключаемые',
  'Capacitance': 'Ёмкость',
  'Varactors': 'Варакторы',
  'Shielding': 'Экранирование',
  'Absorbing': 'Поглощающие',
  'Fingerstock': 'Контактные пластины',
  'Gaskets': 'Прокладки',
  'Gasket': 'Прокладка',
  'Subscriber': 'Абонентский',
  'Identification': 'Идентификации',
  'SIM': 'SIM',
  'Cards': 'Карты',
  'Card': 'Карта',
  'Incandescent': 'Накаливания',
  'Neon': 'Неон',
  'Indication': 'Индикация',
  'Pilot': 'Контрольные',
  'Replacements': 'Запасные',
  'Overlays': 'Накладки',
  'Matrix': 'Матрица',
  'Cluster': 'Кластер',
  'Rechargeable': 'Перезаряжаемые',
  'Cigarette': 'Сигаретный',
  'Lighter': 'Зажигалка',
  'PTFE': 'ПТФЭ',
  'HVAC': 'ОВиК',

  'Circulators': 'Циркуляторы',
  'Felt': 'Войлок',
  'Fuel': 'Топливо',
  'Oil': 'Масло',
  'Occupancy': 'Присутствия',
  'Swabs': 'Тампоны',
  'Brushes': 'Щётки',
  'Brush': 'Щётка',
  'Bezels': 'Ободки',
  'Bezel': 'Ободок',
  'Hoses': 'Шланги',
  'Hose': 'Шланг',
  'Lugs': 'Наконечники',
  'Lug': 'Наконечник',
  'Points': 'Точки',
  'Point': 'Точка',
  'Inclinometers': 'Инклинометры',
  'Inclinometer': 'Инклинометр',
  'Serializers': 'Сериализаторы',
  'Deserializers': 'Десериализаторы',
  'Personal': 'Индивидуальное',
  'Protective': 'Защитное',
  'Equipment': 'Оборудование',
  'PPE': 'СИЗ',
  'Raw': 'Сырьё',
  'Purpose': 'Назначения',
  'Cans': 'Канистры',
  'Pick': 'Выбор',
  'Light': 'Световой',
  'Room': 'Комната',
  'Tubing': 'Трубки',
  'Sleeving': 'Оплётка',
  'Sleeve': 'Рукав',
  'Conditioning': 'Обработка',
  'Units': 'Блоки',
  'Unit': 'Блок',
  'Finished': 'Готовые',
  'Abrasives': 'Абразивы',
  'Surface': 'Поверхность',
  'Products': 'Продукция',
  'Product': 'Продукт',
  'General': 'Общего',

  // ===== Multi-word phrases (must come first) =====
  'Heavy Duty': 'Усиленный',
  'Clean Room': 'Чистая комната',
  'Special Purpose': 'Специального назначения',
  'Board to Board': 'Плата-плата',
  'Wire to Board': 'Провод-плата',
  'Cable to Board': 'Кабель-плата',
  'Power over Ethernet': 'Питание через Ethernet',
  'Surface Mount': 'Поверхностный монтаж',
  'Through Hole': 'Выводной монтаж',
  'Op Amps': 'Операционные усилители',
  'Fiber Optic': 'Оптоволоконный',
  'Non-Rechargeable': 'Неперезаряжаемые',
  'Floor Markings': 'Напольная разметка',
  'Power Supply': 'Блок питания',
  'Power Supplies': 'Блоки питания',
  'Anti-Static': 'Антистатический',
  'Heat Sink': 'Радиатор',
  'Heat Sinks': 'Радиаторы',
  'Factory Assembled': 'Заводская сборка',
  'Edge Type': 'Краевой',
  'Solid State': 'Твердотельный',
  'Real Time': 'Реального времени',
  'High Speed': 'Высокоскоростной',
  'Low Power': 'Маломощный',
  'High Power': 'Мощный',
  'Bar Code': 'Штрих-код',
  
  // ===== Single words =====
  // A
  'Abrasives': 'Абразивы',
  'Absorbents': 'Абсорбенты',
  'Accelerometers': 'Акселерометры',
  'Accelerometer': 'Акселерометр',
  'Accessories': 'Аксессуары',
  'Accessory': 'Аксессуар',
  'Actuators': 'Приводы',
  'Actuator': 'Привод',
  'Adapters': 'Адаптеры',
  'Adapter': 'Адаптер',
  'Adhesives': 'Клеи',
  'Adhesive': 'Клей',
  'Adjustable': 'Регулируемый',
  'Agricultural': 'Сельскохозяйственный',
  'Alarms': 'Сигнализаторы',
  'Alarm': 'Сигнализатор',
  'Alligator': 'Крокодил',
  'Ambient': 'Окружающей среды',
  'Amplifier': 'Усилитель',
  'Amplifiers': 'Усилители',
  'Analog': 'Аналоговый',
  'Analyzers': 'Анализаторы',
  'Analyzer': 'Анализатор',
  'Angle': 'Угловой',
  'Antennas': 'Антенны',
  'Antenna': 'Антенна',
  'Applicators': 'Аппликаторы',
  'Arms': 'Держатели',
  'Arrays': 'Сборки',
  'Array': 'Сборка',
  'Assemblies': 'Сборки',
  'Assembly': 'Сборка',
  'Assorted': 'Разные',
  'Attenuators': 'Аттенюаторы',
  'Attenuator': 'Аттенюатор',
  'Audio': 'Аудио',
  
  // B
  'Backplane': 'Объединительная плата',
  'Backplanes': 'Объединительные платы',
  'Backshells': 'Кожухи',
  'Backshell': 'Кожух',
  'Bags': 'Пакеты',
  'Bag': 'Пакет',
  'Ballasts': 'Балласты',
  'Ballast': 'Балласт',
  'Balun': 'Балун',
  'Banana': 'Банановый',
  'Barrel': 'Цилиндрический',
  'Barriers': 'Барьеры',
  'Barrier': 'Барьер',
  'Barricades': 'Ограждения',
  'Bases': 'Основания',
  'Base': 'Основание',
  'Batteries': 'Батареи',
  'Battery': 'Батарея',
  'Beamsplitters': 'Светоделители',
  'Bearings': 'Подшипники',
  'Bearing': 'Подшипник',
  'Bench': 'Лабораторный',
  'Between': 'Между',
  'Bipolar': 'Биполярный',
  'Blade': 'Ножевой',
  'Blocks': 'Блоки',
  'Block': 'Блок',
  'Blowers': 'Воздуходувки',
  'Blower': 'Воздуходувка',
  'Boards': 'Платы',
  'Board': 'Плата',
  'Bobbins': 'Каркасы',
  'Bobbin': 'Каркас',
  'Books': 'Книги',
  'Book': 'Книга',
  'Boots': 'Чехлы',
  'Boot': 'Чехол',
  'Bottles': 'Бутылки',
  'Bottle': 'Бутылка',
  'Boxes': 'Корпуса',
  'Box': 'Корпус',
  'Brackets': 'Кронштейны',
  'Bracket': 'Кронштейн',
  'Breakout': 'Коммутационная',
  'Bridges': 'Мосты',
  'Bridge': 'Мост',
  'Buffers': 'Буферы',
  'Buffer': 'Буфер',
  'Building': 'Строительный',
  'Bullet': 'Штекерный',
  'Bumpers': 'Демпферы',
  'Bumper': 'Демпфер',
  'Bus': 'Шина',
  'Bushings': 'Втулки',
  'Bushing': 'Втулка',
  'Buzzers': 'Зуммеры',
  'Buzzer': 'Зуммер',
  
  // C
  'Cabinets': 'Шкафы',
  'Cabinet': 'Шкаф',
  'Cables': 'Кабели',
  'Cable': 'Кабель',
  'Cabling': 'Прокладка',
  'Cans': 'Корпуса',
  'Can': 'Корпус',
  'Capacitors': 'Конденсаторы',
  'Capacitor': 'Конденсатор',
  'Caps': 'Крышки',
  'Cap': 'Крышка',
  'Cards': 'Карты',
  'Card': 'Карта',
  'Ceiling': 'Потолочный',
  'Cells': 'Элементы',
  'Cell': 'Элемент',
  'Ceramic': 'Керамический',
  'Chains': 'Цепи',
  'Chain': 'Цепь',
  'Chairs': 'Стулья',
  'Chair': 'Стул',
  'Character': 'Символьный',
  'Chargers': 'Зарядные',
  'Charger': 'Зарядное',
  'Chassis': 'Шасси',
  'Chips': 'Чипы',
  'Chip': 'Чип',
  'Chokes': 'Дроссели',
  'Choke': 'Дроссель',
  'Circuits': 'Схемы',
  'Circuit': 'Схема',
  'Circular': 'Круглый',
  'Clamps': 'Зажимы',
  'Clamp': 'Зажим',
  'Cleaners': 'Очистители',
  'Cleaner': 'Очиститель',
  'Cleaning': 'Очистка',
  'Clips': 'Зажимы',
  'Clip': 'Зажим',
  'Clocks': 'Часы',
  'Clock': 'Тактовый',
  'Clothing': 'Одежда',
  'Coaxial': 'Коаксиальный',
  'Coils': 'Катушки',
  'Coil': 'Катушка',
  'Cold': 'Холодный',
  'Color': 'Цветной',
  'Comparators': 'Компараторы',
  'Comparator': 'Компаратор',
  'Complex': 'Сложный',
  'Components': 'Компоненты',
  'Component': 'Компонент',
  'Compressors': 'Компрессоры',
  'Compressor': 'Компрессор',
  'Computers': 'Компьютеры',
  'Computer': 'Компьютер',
  'Computing': 'Вычисления',
  'Conditioners': 'Кондиционеры',
  'Conditioner': 'Кондиционер',
  'Conductors': 'Проводники',
  'Conductor': 'Проводник',
  'Configurable': 'Конфигурируемый',
  'Connectors': 'Разъёмы',
  'Connector': 'Разъём',
  'Construction': 'Строительство',
  'Contacts': 'Контакты',
  'Contact': 'Контакт',
  'Containers': 'Контейнеры',
  'Container': 'Контейнер',
  'Controllers': 'Контроллеры',
  'Controller': 'Контроллер',
  'Control': 'Управление',
  'Controls': 'Управление',
  'Converters': 'Преобразователи',
  'Converter': 'Преобразователь',
  'Cooling': 'Охлаждение',
  'Cords': 'Шнуры',
  'Cord': 'Шнур',
  'Counters': 'Счётчики',
  'Counter': 'Счётчик',
  'Covers': 'Крышки',
  'Cover': 'Крышка',
  'Crimpers': 'Обжимники',
  'Crimper': 'Обжимник',
  'Crocodile': 'Крокодил',
  'Current': 'Тока',
  'Curtain': 'Завеса',
  'Cutters': 'Резаки',
  'Cutter': 'Резак',
  'Cylinders': 'Цилиндры',
  'Cylinder': 'Цилиндр',
  
  // D
  'Data': 'Данных',
  'Debuggers': 'Отладчики',
  'Debugger': 'Отладчик',
  'Decoders': 'Декодеры',
  'Decoder': 'Декодер',
  'Dehumidifiers': 'Осушители',
  'Delay': 'Задержки',
  'Delivery': 'Доставка',
  'Demonstration': 'Демонстрационные',
  'Demultiplexers': 'Демультиплексоры',
  'Desoldering': 'Демонтаж',
  'Desktop': 'Настольный',
  'Detectors': 'Детекторы',
  'Detector': 'Детектор',
  'Development': 'Разработка',
  'Devices': 'Устройства',
  'Device': 'Устройство',
  'Dials': 'Шкалы',
  'Dial': 'Шкала',
  'Digital': 'Цифровой',
  'Diodes': 'Диоды',
  'Diode': 'Диод',
  'Direct': 'Прямой',
  'Discrete': 'Дискретный',
  'Dispensers': 'Дозаторы',
  'Dispenser': 'Дозатор',
  'Displays': 'Дисплеи',
  'Display': 'Дисплей',
  'Distribution': 'Распределение',
  'Dividers': 'Делители',
  'Divider': 'Делитель',
  'Dock': 'Докстанция',
  'Doors': 'Двери',
  'Door': 'Дверь',
  'Drivers': 'Драйверы',
  'Driver': 'Драйвер',
  'Drives': 'Приводы',
  'Drive': 'Привод',
  'Drum': 'Барабан',
  'Dryers': 'Сушилки',
  'Dryer': 'Сушилка',
  'Dual': 'Двойной',
  'Duct': 'Канал',
  'Ducts': 'Каналы',
  
  // E
  'Edge': 'Краевой',
  'Educational': 'Образовательный',
  'Electric': 'Электрический',
  'Electrical': 'Электрический',
  'Electronic': 'Электронный',
  'Electronics': 'Электроника',
  'Elements': 'Элементы',
  'Element': 'Элемент',
  'Embedded': 'Встраиваемый',
  'Emitters': 'Излучатели',
  'Emitter': 'Излучатель',
  'Emulators': 'Эмуляторы',
  'Emulator': 'Эмулятор',
  'Encoders': 'Энкодеры',
  'Encoder': 'Энкодер',
  'Enclosures': 'Корпуса',
  'Enclosure': 'Корпус',
  'Engines': 'Модули',
  'Engine': 'Модуль',
  'Epoxies': 'Эпоксидные',
  'Epoxy': 'Эпоксидный',
  'Equipment': 'Оборудование',
  'Evaluation': 'Оценочные',
  'Exhaust': 'Вытяжка',
  'Expanders': 'Расширители',
  'Expander': 'Расширитель',
  'Extensions': 'Удлинители',
  'Extension': 'Удлинитель',
  'External': 'Внешний',
  
  // F
  'Fabrication': 'Изготовление',
  'Families': 'Семейства',
  'Family': 'Семейство',
  'Fans': 'Вентиляторы',
  'Fan': 'Вентилятор',
  'Fasteners': 'Крепёж',
  'Fastener': 'Крепёж',
  'Feet': 'Ножки',
  'Foot': 'Ножка',
  'Female': 'Гнездовой',
  'Ferrite': 'Феррит',
  'Ferrites': 'Ферриты',
  'Fiber': 'Волоконный',
  'Fibers': 'Волокна',
  'Field': 'Поле',
  'Film': 'Плёночный',
  'Filters': 'Фильтры',
  'Filter': 'Фильтр',
  'Fixed': 'Постоянный',
  'Fixtures': 'Светильники',
  'Fixture': 'Светильник',
  'Flat': 'Плоский',
  'Flex': 'Гибкий',
  'Flexible': 'Гибкий',
  'Floor': 'Напольный',
  'Flow': 'Поток',
  'Foil': 'Фольговый',
  'Food': 'Пищевой',
  'Force': 'Силы',
  'Formers': 'Каркасы',
  'Former': 'Каркас',
  'Frequency': 'Частота',
  'Front': 'Передний',
  'Full': 'Полный',
  'Furnaces': 'Печи',
  'Furnace': 'Печь',
  'Furniture': 'Мебель',
  'Fuseholders': 'Держатели',
  'Fuses': 'Предохранители',
  'Fuse': 'Предохранитель',
  
  // G
  'Gas': 'Газ',
  'Gate': 'Затвор',
  'Gates': 'Затворы',
  'Gauges': 'Датчики',
  'Gauge': 'Датчик',
  'Generators': 'Генераторы',
  'Generator': 'Генератор',
  'Glass': 'Стекло',
  'Graphic': 'Графический',
  'Graphics': 'Графика',
  'Greases': 'Смазки',
  'Grease': 'Смазка',
  'Grips': 'Захваты',
  'Grip': 'Захват',
  'Grommets': 'Втулки',
  'Grommet': 'Втулка',
  'Grounding': 'Заземление',
  
  // H
  'Half': 'Полу',
  'Handlers': 'Устройства',
  'Handler': 'Устройство',
  'Handles': 'Ручки',
  'Handle': 'Ручка',
  'Hardware': 'Комплектующие',
  'Headers': 'Разъёмы',
  'Header': 'Разъём',
  'Heat': 'Теплоотвод',
  'Heaters': 'Нагреватели',
  'Heater': 'Нагреватель',
  'Heatsinks': 'Радиаторы',
  'Heatsink': 'Радиатор',
  'High': 'Высокий',
  'Holders': 'Держатели',
  'Holder': 'Держатель',
  'Hole': 'Отверстие',
  'Hooks': 'Крючки',
  'Hook': 'Крючок',
  'Hoods': 'Кожухи',
  'Hood': 'Кожух',
  'Hot': 'Горячий',
  'Housings': 'Корпуса',
  'Housing': 'Корпус',
  'Humidifiers': 'Увлажнители',
  'Humidifier': 'Увлажнитель',
  'Humidity': 'Влажность',
  
  // I
  'Identification': 'Идентификация',
  'Image': 'Изображение',
  'Indicators': 'Индикаторы',
  'Indicator': 'Индикатор',
  'Indoor': 'Внутренний',
  'Industrial': 'Промышленный',
  'Inductors': 'Катушки',
  'Inductor': 'Катушка',
  'Inertial': 'Инерционный',
  'Infrared': 'Инфракрасный',
  'Input': 'Вход',
  'Inserts': 'Вставки',
  'Insert': 'Вставка',
  'Inspection': 'Контроль',
  'Instruments': 'Инструменты',
  'Instrument': 'Инструмент',
  'Insulators': 'Изоляторы',
  'Insulator': 'Изолятор',
  'Integrated': 'Интегральный',
  'Interconnects': 'Коммутация',
  'Interface': 'Интерфейс',
  'Internal': 'Внутренний',
  'Inverters': 'Инверторы',
  'Inverter': 'Инвертор',
  'Isolation': 'Изоляция',
  'Isolators': 'Изоляторы',
  'Isolator': 'Изолятор',
  
  // J
  'Jacks': 'Гнёзда',
  'Jack': 'Гнездо',
  'Joysticks': 'Джойстики',
  'Joystick': 'Джойстик',
  'Jumpers': 'Перемычки',
  'Jumper': 'Перемычка',
  
  // K
  'Keyboards': 'Клавиатуры',
  'Keyboard': 'Клавиатура',
  'Keylock': 'Ключевой',
  'Keystone': 'Keystone',
  'Kits': 'Наборы',
  'Kit': 'Набор',
  
  // L
  'Labels': 'Этикетки',
  'Label': 'Этикетка',
  'Lamps': 'Лампы',
  'Lamp': 'Лампа',
  'Laser': 'Лазер',
  'Lasers': 'Лазеры',
  'Latches': 'Защёлки',
  'Latch': 'Защёлка',
  'Lawn': 'Садовый',
  'Lenses': 'Линзы',
  'Lens': 'Линза',
  'Level': 'Уровень',
  'Light': 'Свет',
  'Lighting': 'Освещение',
  'Limiters': 'Ограничители',
  'Limiter': 'Ограничитель',
  'Lines': 'Линии',
  'Line': 'Линия',
  'Linear': 'Линейный',
  'Liquid': 'Жидкий',
  'Loads': 'Нагрузки',
  'Load': 'Нагрузка',
  'Locks': 'Замки',
  'Lock': 'Замок',
  'Logic': 'Логика',
  'Low': 'Низкий',
  
  // M
  'Machine': 'Машина',
  'Machines': 'Машины',
  'Magnetic': 'Магнитный',
  'Magnetics': 'Магнитные',
  'Magnets': 'Магниты',
  'Magnet': 'Магнит',
  'Maintenance': 'Обслуживание',
  'Male': 'Штыревой',
  'Management': 'Управление',
  'Markers': 'Маркеры',
  'Marker': 'Маркер',
  'Materials': 'Материалы',
  'Material': 'Материал',
  'Mats': 'Коврики',
  'Mat': 'Коврик',
  'Measurement': 'Измерение',
  'Measuring': 'Измерение',
  'Mechanical': 'Механический',
  'Media': 'Носители',
  'Medium': 'Средний',
  'Memory': 'Память',
  'Meters': 'Измерители',
  'Meter': 'Измеритель',
  'Mezzanine': 'Мезонинный',
  'Micro': 'Микро',
  'Microcontrollers': 'Микроконтроллеры',
  'Microcontroller': 'Микроконтроллер',
  'Microphones': 'Микрофоны',
  'Microphone': 'Микрофон',
  'Microprocessors': 'Микропроцессоры',
  'Microprocessor': 'Микропроцессор',
  'Miscellaneous': 'Разное',
  'Mixers': 'Смесители',
  'Mixer': 'Смеситель',
  'Mixed': 'Смешанный',
  'Mobile': 'Мобильный',
  'Modems': 'Модемы',
  'Modem': 'Модем',
  'Modular': 'Модульный',
  'Modules': 'Модули',
  'Module': 'Модуль',
  'Monitors': 'Мониторы',
  'Monitor': 'Монитор',
  'Motion': 'Движение',
  'Motors': 'Двигатели',
  'Motor': 'Двигатель',
  'Mount': 'Монтаж',
  'Mounting': 'Монтаж',
  'Mounts': 'Крепления',
  'Mouse': 'Мышь',
  'Multi': 'Много',
  'Multimeters': 'Мультиметры',
  'Multimeter': 'Мультиметр',
  'Multiplexers': 'Мультиплексоры',
  'Multiplexer': 'Мультиплексор',
  'Multipliers': 'Умножители',
  'Multiplier': 'Умножитель',
  
  // N
  'Navigation': 'Навигация',
  'Network': 'Сеть',
  'Networking': 'Сетевой',
  'Networks': 'Сети',
  'Noise': 'Шум',
  'Numeric': 'Цифровой',
  'Nuts': 'Гайки',
  'Nut': 'Гайка',
  
  // O
  'Office': 'Офисный',
  'Offline': 'Автономный',
  'Optic': 'Оптический',
  'Optical': 'Оптический',
  'Optics': 'Оптика',
  'Optoelectronics': 'Оптоэлектроника',
  'Optoisolators': 'Оптроны',
  'Optoisolator': 'Оптрон',
  'Oscillators': 'Генераторы',
  'Oscillator': 'Генератор',
  'Oscilloscopes': 'Осциллографы',
  'Oscilloscope': 'Осциллограф',
  'Outdoor': 'Наружный',
  'Output': 'Выход',
  'Outputs': 'Выходы',
  'Over': 'Свыше',
  
  // P
  'Packs': 'Блоки',
  'Pack': 'Блок',
  'Pads': 'Накладки',
  'Pad': 'Накладка',
  'Panels': 'Панели',
  'Panel': 'Панель',
  'Parts': 'Детали',
  'Part': 'Деталь',
  'Passive': 'Пассивный',
  'Pastes': 'Пасты',
  'Paste': 'Паста',
  'Perforated': 'Перфорированный',
  'Photo': 'Фото',
  'Photoelectric': 'Фотоэлектрический',
  'Photovoltaic': 'Фотогальванический',
  'Piezo': 'Пьезо',
  'Pins': 'Контакты',
  'Pin': 'Контакт',
  'Plates': 'Пластины',
  'Plate': 'Пластина',
  'Pluggable': 'Подключаемый',
  'Plugs': 'Вилки',
  'Plug': 'Вилка',
  'Portable': 'Портативный',
  'Position': 'Положение',
  'Posts': 'Стойки',
  'Post': 'Стойка',
  'Potentiometers': 'Потенциометры',
  'Potentiometer': 'Потенциометр',
  'Power': 'Питание',
  'Precision': 'Прецизионный',
  'Preparation': 'Приготовление',
  'Pressure': 'Давление',
  'Primary': 'Первичный',
  'Printers': 'Принтеры',
  'Printer': 'Принтер',
  'Printing': 'Печать',
  'Probes': 'Щупы',
  'Probe': 'Щуп',
  'Processors': 'Процессоры',
  'Processor': 'Процессор',
  'Products': 'Продукция',
  'Product': 'Продукт',
  'Professional': 'Профессиональный',
  'Programmable': 'Программируемый',
  'Programmers': 'Программаторы',
  'Programmer': 'Программатор',
  'Programming': 'Программирование',
  'Protection': 'Защита',
  'Protectors': 'Защитные',
  'Protector': 'Защитный',
  'Prototype': 'Макетная',
  'Prototyping': 'Прототипирование',
  'Proximity': 'Приближение',
  'Pull': 'Тяговый',
  'Purifiers': 'Очистители',
  'Purifier': 'Очиститель',
  'Purpose': 'Назначение',
  
  // Q
  'Quad': 'Четырёхканальный',
  
  // R
  'Racks': 'Стойки',
  'Rack': 'Стойка',
  'Radio': 'Радио',
  'Rail': 'Рейка',
  'Readers': 'Считыватели',
  'Reader': 'Считыватель',
  'Real': 'Реальный',
  'Receivers': 'Приёмники',
  'Receiver': 'Приёмник',
  'Receptacles': 'Гнёзда',
  'Receptacle': 'Гнездо',
  'Rectangular': 'Прямоугольный',
  'Rectifiers': 'Выпрямители',
  'Rectifier': 'Выпрямитель',
  'Reference': 'Опорный',
  'Reflective': 'Отражательный',
  'Regulators': 'Стабилизаторы',
  'Regulator': 'Стабилизатор',
  'Relays': 'Реле',
  'Relay': 'Реле',
  'Remote': 'Дистанционный',
  'Repair': 'Ремонт',
  'Resistors': 'Резисторы',
  'Resistor': 'Резистор',
  'Resonators': 'Резонаторы',
  'Resonator': 'Резонатор',
  'Rework': 'Ремонт',
  'Ribbon': 'Ленточный',
  'Rings': 'Кольца',
  'Ring': 'Кольцо',
  'Robots': 'Роботы',
  'Robot': 'Робот',
  'Robotics': 'Робототехника',
  'Rocker': 'Клавишный',
  'Rotary': 'Поворотный',
  'Routers': 'Маршрутизаторы',
  'Router': 'Маршрутизатор',
  
  // S
  'Safety': 'Безопасность',
  'Scale': 'Шкала',
  'Screen': 'Экран',
  'Screwdrivers': 'Отвёртки',
  'Screwdriver': 'Отвёртка',
  'Screws': 'Винты',
  'Screw': 'Винт',
  'Seals': 'Уплотнители',
  'Seal': 'Уплотнитель',
  'Secondary': 'Вторичный',
  'Semiconductors': 'Полупроводники',
  'Semiconductor': 'Полупроводник',
  'Sensors': 'Датчики',
  'Sensor': 'Датчик',
  'Serial': 'Последовательный',
  'Series': 'Серии',
  'Servers': 'Серверы',
  'Server': 'Сервер',
  'Sets': 'Наборы',
  'Set': 'Набор',
  'Shaped': 'Формованный',
  'Shelf': 'Полка',
  'Shelving': 'Стеллажи',
  'Shields': 'Экраны',
  'Shield': 'Экран',
  'Shock': 'Ударный',
  'Shoulder': 'Упорный',
  'Shrink': 'Термоусадка',
  'Shunts': 'Шунты',
  'Shunt': 'Шунт',
  'Signals': 'Сигналы',
  'Signal': 'Сигнал',
  'Signs': 'Знаки',
  'Sign': 'Знак',
  'Silicon': 'Кремниевый',
  'Single': 'Одиночный',
  'Sinks': 'Радиаторы',
  'Sink': 'Радиатор',
  'Sirens': 'Сирены',
  'Siren': 'Сирена',
  'Sleeving': 'Оплётка',
  'Slide': 'Ползунковый',
  'Smart': 'Умный',
  'Snap': 'Защёлкивающийся',
  'Sockets': 'Панельки',
  'Socket': 'Панелька',
  'Software': 'ПО',
  'Solar': 'Солнечный',
  'Solder': 'Припой',
  'Soldering': 'Пайка',
  'Solenoids': 'Соленоиды',
  'Solenoid': 'Соленоид',
  'Solid': 'Твёрдотельный',
  'Solutions': 'Решения',
  'Solution': 'Решение',
  'Sound': 'Звук',
  'Sources': 'Источники',
  'Source': 'Источник',
  'Spacers': 'Стойки',
  'Spacer': 'Стойка',
  'Speakers': 'Динамики',
  'Speaker': 'Динамик',
  'Special': 'Специальный',
  'Specialized': 'Специализированный',
  'Specialty': 'Специальный',
  'Speed': 'Скорость',
  'Spiral': 'Спиральный',
  'Splice': 'Сращивание',
  'Splitters': 'Разветвители',
  'Splitter': 'Разветвитель',
  'Springs': 'Пружины',
  'Spring': 'Пружина',
  'Stackers': 'Укладчики',
  'Stacker': 'Укладчик',
  'Standard': 'Стандартный',
  'Standoffs': 'Стойки',
  'Standoff': 'Стойка',
  'Stands': 'Подставки',
  'Stand': 'Подставка',
  'State': 'Состояние',
  'Static': 'Статический',
  'Stations': 'Станции',
  'Station': 'Станция',
  'Step': 'Шаг',
  'Stepper': 'Шаговый',
  'Stickers': 'Наклейки',
  'Sticker': 'Наклейка',
  'Stools': 'Табуреты',
  'Stool': 'Табурет',
  'Stop': 'Стоп',
  'Storage': 'Хранение',
  'Straps': 'Ремни',
  'Strap': 'Ремень',
  'Strippers': 'Стрипперы',
  'Stripper': 'Стриппер',
  'Strips': 'Ленты',
  'Strip': 'Лента',
  'Structural': 'Конструкционный',
  'Structures': 'Конструкции',
  'Structure': 'Конструкция',
  'Supplies': 'Материалы',
  'Supply': 'Питание',
  'Supports': 'Опоры',
  'Support': 'Опора',
  'Suppressors': 'Подавители',
  'Suppressor': 'Подавитель',
  'Surface': 'Поверхностный',
  'Surge': 'Импульсный',
  'Switches': 'Переключатели',
  'Switch': 'Переключатель',
  'Switching': 'Импульсный',
  'Synthesizers': 'Синтезаторы',
  'Synthesizer': 'Синтезатор',
  'Syringes': 'Шприцы',
  'Syringe': 'Шприц',
  'Systems': 'Системы',
  'System': 'Система',
  
  // T
  'Tactile': 'Тактильный',
  'Tags': 'Бирки',
  'Tag': 'Бирка',
  'Tantalum': 'Танталовый',
  'Tapered': 'Конический',
  'Tapes': 'Ленты',
  'Tape': 'Лента',
  'Task': 'Рабочий',
  'Technology': 'Технология',
  'Temperature': 'Температура',
  'Terminal': 'Клеммы',
  'Terminals': 'Клеммы',
  'Terminators': 'Терминаторы',
  'Terminator': 'Терминатор',
  'Test': 'Тест',
  'Testers': 'Тестеры',
  'Tester': 'Тестер',
  'Testing': 'Тестирование',
  'Thermal': 'Термо',
  'Thermoelectric': 'Термоэлектрический',
  'Thermistors': 'Термисторы',
  'Thermistor': 'Термистор',
  'Thermocouples': 'Термопары',
  'Thermocouple': 'Термопара',
  'Thermostats': 'Термостаты',
  'Thermostat': 'Термостат',
  'Thick': 'Толстоплёночный',
  'Thin': 'Тонкоплёночный',
  'Through': 'Выводной',
  'Thumbwheel': 'Колёсный',
  'Ties': 'Стяжки',
  'Tie': 'Стяжка',
  'Tilt': 'Наклон',
  'Time': 'Время',
  'Timers': 'Таймеры',
  'Timer': 'Таймер',
  'Timing': 'Синхронизация',
  'Tips': 'Жала',
  'Tip': 'Жало',
  'Toggle': 'Тумблер',
  'Tools': 'Инструменты',
  'Tool': 'Инструмент',
  'Touch': 'Сенсорный',
  'Transceivers': 'Трансиверы',
  'Transceiver': 'Трансивер',
  'Transducers': 'Преобразователи',
  'Transducer': 'Преобразователь',
  'Transformers': 'Трансформаторы',
  'Transformer': 'Трансформатор',
  'Transistors': 'Транзисторы',
  'Transistor': 'Транзистор',
  'Transmitters': 'Передатчики',
  'Transmitter': 'Передатчик',
  'Trays': 'Лотки',
  'Tray': 'Лоток',
  'Triggers': 'Триггеры',
  'Trigger': 'Триггер',
  'Trimmers': 'Подстроечные',
  'Trimmer': 'Подстроечный',
  'Triple': 'Тройной',
  'Trucks': 'Тележки',
  'Truck': 'Тележка',
  'Tubes': 'Трубки',
  'Tube': 'Трубка',
  'Tubing': 'Трубки',
  'Tuners': 'Тюнеры',
  'Tuner': 'Тюнер',
  'Tuning': 'Настройка',
  'Turret': 'Турель',
  'Tweezers': 'Пинцеты',
  'Tweezer': 'Пинцет',
  'Type': 'Тип',
  
  // U
  'Ultrasonic': 'Ультразвуковой',
  'Units': 'Блоки',
  'Unit': 'Блок',
  'Universal': 'Универсальный',
  
  // V
  'Vacuum': 'Вакуум',
  'Vacuums': 'Пылесосы',
  'Valves': 'Клапаны',
  'Valve': 'Клапан',
  'Variable': 'Переменный',
  'Video': 'Видео',
  'Vision': 'Видеоконтроль',
  'Voltage': 'Напряжение',
  
  // W
  'Wall': 'Настенный',
  'Washers': 'Шайбы',
  'Washer': 'Шайба',
  'White': 'Белый',
  'Wire': 'Провод',
  'Wires': 'Провода',
  'Wireless': 'Беспроводной',
  'Wiring': 'Монтаж',
  'Workbenches': 'Рабочие столы',
  'Workbench': 'Рабочий стол',
  'Workstations': 'Рабочие станции',
  'Workstation': 'Рабочая станция',
  'Wrap': 'Обмотка',
  'Wrenches': 'Ключи',
  'Wrench': 'Ключ',
  
  // Z
  'Zener': 'Зенера',
  
  // Technical abbreviations (keep as-is or translate)
  'AC': 'AC',
  'DC': 'DC',
  'IR': 'ИК',
  'UV': 'УФ',
  'RF': 'РЧ',
  'LED': 'LED',
  'LCD': 'ЖК',
  'ADC': 'АЦП',
  'DAC': 'ЦАП',
  'ADCs': 'АЦП',
  'DACs': 'ЦАП',
  'IC': 'ИС',
  'ICs': 'ИС',
  'PCB': 'PCB',
  'SMD': 'SMD',
  'USB': 'USB',
  'DVI': 'DVI',
  'HDMI': 'HDMI',
  'BNC': 'BNC',
  'FFC': 'FFC',
  'FPC': 'FPC',
  'DIN': 'DIN',
  'BJT': 'BJT',
  'FET': 'FET',
  'FETs': 'FET',
  'MOSFET': 'MOSFET',
  'MOSFETs': 'MOSFET',
  'IGBT': 'IGBT',
  'IGBTs': 'IGBT',
  'JFET': 'JFET',
  'JFETs': 'JFET',
  'SCR': 'SCR',
  'SCRs': 'SCR',
  'TRIAC': 'TRIAC',
  'TRIACs': 'TRIAC',
  'DIAC': 'DIAC',
  'DIACs': 'DIAC',
  'SIDAC': 'SIDAC',
  'SIDACs': 'SIDAC',
  'PTC': 'PTC',
  'NTC': 'NTC',
  'RTD': 'RTD',
  'TVS': 'TVS',
  'GDT': 'GDT',
  'PMIC': 'PMIC',
  'LDO': 'LDO',
  'PoE': 'PoE',
  'PFC': 'PFC',
  'RMS': 'RMS',
  'FPGA': 'FPGA',
  'FPGAs': 'FPGA',
  'CPLD': 'CPLD',
  'CPLDs': 'CPLD',
  'DSP': 'DSP',
  'MPU': 'MPU',
  'MCU': 'MCU',
  'SoC': 'SoC',
  'UART': 'UART',
  'USART': 'USART',
  'SPI': 'SPI',
  'I2C': 'I2C',
  'CAN': 'CAN',
  'LIN': 'LIN',
  'FIFO': 'FIFO',
  'PLL': 'PLL',
  'PLLs': 'PLL',
  'VCO': 'VCO',
  'VCOs': 'VCO',
  'EMI': 'EMI',
  'EMC': 'EMC',
  'ESD': 'ESD',
  'ICL': 'ICL',
  'COB': 'COB',
  'COBs': 'COB',
  'RGB': 'RGB',
  'GPS': 'GPS',
  'NFC': 'NFC',
  'RFID': 'RFID',
  'WiFi': 'WiFi',
  'LoRa': 'LoRa',
  'LCR': 'LCR',
  'SMPS': 'ИИП',
  'OLED': 'OLED',
  'ARINC': 'ARINC',
  'AFE': 'AFE',
  'EDLC': 'EDLC',
  'PTFE': 'PTFE',
  'IMU': 'IMU',
  'IMUs': 'IMU',
  'Op': 'Операционный',
  'Amps': 'А',
  'Amp': 'А',
  // Conjunctions and prepositions
  'and': 'и',
  'or': 'или',
  'with': 'с',
  'for': 'для',
  'to': 'к',
  'from': 'от',
  'by': 'по',
  'in': 'в',
  'on': 'на',
  'over': 'свыше',
  

  // More terms
  'Nozzles': 'Насадки',
  'Nozzle': 'Насадка',
  'Contactors': 'Контакторы',
  'Contactor': 'Контактор',
  'Compass': 'Компас',
  'Channel': 'Канал',
  'Channels': 'Каналы',
  'Centronics': 'Centronics',
  'Carts': 'Тележки',
  'Cart': 'Тележка',
  'Cameras': 'Камеры',
  'Camera': 'Камера',
  'Bins': 'Лотки',
  'Bin': 'Лоток',
  'Assortment': 'Ассортимент',
  'Application': 'Применение',
  'Acquisition': 'Сбор',
  'With': 'С',
  'with': 'с',
  'Wipes': 'Салфетки',
  'Wipe': 'Салфетка',
  'Wick': 'Оплётка',
  'Weather': 'Погода',
  'Wearables': 'Носимые',
  'Wearable': 'Носимый',
  'Water': 'Вода',
  'Warehouse': 'Склад',
  'Voice': 'Голос',
  'Visible': 'Видимый',
  'Vises': 'Тиски',
  'Vise': 'Тиски',
  'Vibration': 'Вибрация',
  'Vehicle': 'Транспорт',
  'Varistors': 'Варисторы',
  'Varistor': 'Варистор',
  'Varicaps': 'Варикапы',
  'Varactors': 'Варакторы',
  'Vapor': 'Пар',
  'Value': 'Значение',
  'Unperforated': 'Неперфорированный',
  'Uninterruptible': 'Бесперебойный',
  'Unijunction': 'Однопереходный',
  'Turntables': 'Поворотные столы',
  'Turntable': 'Поворотный стол',
  'Trimmed': 'Обрезанный',
  'Treatments': 'Обработка',
  'Treatment': 'Обработка',
  'Trash': 'Мусор',
  'Common': 'Общий',
  'Mode': 'Режим',
  'Free': 'Свободный',
  'Hanging': 'Подвесной',
  'Backlight': 'Подсветка',
  'Backlights': 'Подсветки',
  'Hex': 'Шестигранный',
  'Torx': 'Torx',
  'Keys': 'Ключи',
  'Key': 'Ключ',
  'Hall': 'Холла',
  'Effect': 'Эффект',
  'Recording': 'Запись',
  'Playback': 'Воспроизведение',
  'Raw': 'Сырой',
  'Zip': 'Пластиковые',
  'Double': 'Двойной',
  'Layer': 'Слой',
  'Super': 'Супер',
  'Wide': 'Широкий',
  'Narrow': 'Узкий',
  'Long': 'Длинный',
  'Short': 'Короткий',
  'Round': 'Круглый',
  'Square': 'Квадратный',
  'Straight': 'Прямой',
  'Right': 'Правый',
  'Left': 'Левый',
  'Up': 'Вверх',
  'Down': 'Вниз',
  'Action': 'Действие',
  'Effect': 'Эффект',
  'Effects': 'Эффекты',
  'Open': 'Открытый',
  'Close': 'Закрытый',
  'Closed': 'Закрытый',
  'Isolated': 'Изолированный',
  'Completed': 'Завершённый',
  'Uncompleted': 'Незавершённый',
  'Terminated': 'Терминированный',
  'Unterminated': 'Нетерминированный',
  'Empty': 'Пустой',
  'Filled': 'Заполненный',

  // Additional terms from analysis
  'Specific': 'Специфический',
  'Regulation': 'Регулирование',
  'Raceways': 'Кабельные каналы',
  'Raceway': 'Кабельный канал',
  'Quick': 'Быстрый',
  'Pumps': 'Насосы',
  'Pump': 'Насос',
  'Protective': 'Защитный',
  'Processing': 'Обработка',
  'Presses': 'Прессы',
  'Press': 'Пресс',
  'Pneumatics': 'Пневматика',
  'Pipes': 'Трубы',
  'Pipe': 'Труба',
  'Peltier': 'Пельтье',
  'Patchbay': 'Патч-панель',
  'Mirrors': 'Зеркала',
  'Mirror': 'Зеркало',
  'Loaded': 'Нагруженный',
  'Lights': 'Светильники',
  'Leads': 'Выводы',
  'Lead': 'Вывод',
  'Junction': 'Соединительный',
  'Illumination': 'Освещение',
  'Hubs': 'Хабы',
  'Hub': 'Хаб',
  'Hose': 'Шланг',
  'Heads': 'Головки',
  'Head': 'Головка',
  'Hard': 'Жёсткий',
  'Guns': 'Пистолеты',
  'Gun': 'Пистолет',
  'Function': 'Функция',
  'Frames': 'Рамы',
  'Frame': 'Рама',
  'Foam': 'Пенопласт',
  'Flux': 'Флюс',
  'Fluorescent': 'Флуоресцентный',
  'Finished': 'Готовый',
  'Extraction': 'Вытяжка',
  'Expandable': 'Расширяемый',
  'Ethernet': 'Ethernet',
  'Entry': 'Ввод',
  'Emergency': 'Аварийный',
  'Disconnect': 'Разъединитель',
  'Decals': 'Декали',
  'Decal': 'Декаль',
  'Custom': 'Заказной',
  'Crystals': 'Кристаллы',
  'Crystal': 'Кристалл',
  'Biased': 'Смещённый',
  'Braid': 'Оплётка',
  'Blades': 'Лезвия',
  'Blade': 'Лезвие',
  'Bits': 'Биты',
  'Bit': 'Бит',
  'HVAC': 'HVAC',
  'Human': 'Человеческий',
  'HeNe': 'Гелий-неон',
  'Keystone': 'Keystone',

};

// Open database
const db = new Database(DB_PATH);

// Ensure name_ru column exists
try {
  db.exec('ALTER TABLE catalog_categories ADD COLUMN name_ru TEXT');
  console.log('✓ Added name_ru column');
} catch (e) {
  // Column already exists
}

// Get all categories
const categories = db.prepare('SELECT id, name FROM catalog_categories').all();
console.log(`Found ${categories.length} categories to translate\n`);

// Build sorted term list (longest first for proper replacement)
const sortedTerms = Object.keys(termDict)
  .filter(k => k.length > 1)
  .sort((a, b) => b.length - a.length);

// Translation function
function translate(name) {
  // 1. Check exact match first (for full category names)
  if (exactTranslations[name]) {
    return exactTranslations[name];
  }
  
  // 2. Apply term-by-term translation
  let translated = name;
  
  for (const term of sortedTerms) {
    const escaped = term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    const regex = new RegExp(`\\b${escaped}\\b`, 'gi');
    const replacement = termDict[term];
    if (replacement) {
      translated = translated.replace(regex, replacement);
    }
  }
  
  // 3. Clean up artifacts
  translated = translated
    .replace(/\s+/g, ' ')         // Multiple spaces
    .replace(/\(\s*\)/g, '')      // Empty parentheses
    .replace(/\s*-\s*-\s*/g, ' — ')  // Double dashes
    .replace(/\s*,\s*,\s*/g, ', ') // Double commas
    .replace(/^\s*[,-]\s*/g, '')   // Leading punctuation
    .replace(/\s*[,-]\s*$/g, '')   // Trailing punctuation
    .trim();
  
  return translated;
}

// Update translations
const updateStmt = db.prepare('UPDATE catalog_categories SET name_ru = ? WHERE id = ?');
let exactMatches = 0;
let termTranslated = 0;
let unchanged = 0;

for (const cat of categories) {
  const translated = translate(cat.name);
  
  if (exactTranslations[cat.name]) {
    exactMatches++;
  } else if (translated !== cat.name) {
    termTranslated++;
  } else {
    unchanged++;
  }
  
  updateStmt.run(translated, cat.id);
}

db.close();

console.log('=== Translation Results ===');
console.log(`Exact matches (JSON): ${exactMatches}`);
console.log(`Term translations:    ${termTranslated}`);
console.log(`Unchanged:            ${unchanged}`);
console.log(`Total:                ${categories.length}`);

// Analysis
const db2 = new Database(DB_PATH);

// Count categories with remaining English (4+ letter words)
const withEnglish = db2.prepare(`
  SELECT COUNT(*) as cnt FROM catalog_categories 
  WHERE name_ru GLOB '*[a-zA-Z][a-zA-Z][a-zA-Z][a-zA-Z]*'
`).get();

console.log(`\nCategories still with English (4+ letters): ${withEnglish.cnt}`);

// Show translated samples
console.log('\n=== Fully translated samples: ===');
const samples = db2.prepare(`
  SELECT name, name_ru FROM catalog_categories 
  WHERE name != name_ru AND name_ru NOT GLOB '*[a-zA-Z][a-zA-Z][a-zA-Z][a-zA-Z]*'
  ORDER BY RANDOM() 
  LIMIT 20
`).all();

samples.forEach((s, i) => {
  console.log(`${i + 1}. "${s.name}" → "${s.name_ru}"`);
});

// Show remaining English words
console.log('\n=== Top remaining English words: ===');
const remaining = db2.prepare(`
  SELECT name_ru FROM catalog_categories 
  WHERE name_ru GLOB '*[a-zA-Z][a-zA-Z][a-zA-Z][a-zA-Z]*'
`).all();

const wordCounts = {};
for (const r of remaining) {
  const words = r.name_ru.match(/\b[A-Za-z]{4,}\b/g) || [];
  for (const w of words) {
    wordCounts[w] = (wordCounts[w] || 0) + 1;
  }
}

const topWords = Object.entries(wordCounts)
  .sort((a, b) => b[1] - a[1])
  .slice(0, 30);

topWords.forEach(([word, count]) => {
  console.log(`  ${word}: ${count}`);
});

db2.close();
